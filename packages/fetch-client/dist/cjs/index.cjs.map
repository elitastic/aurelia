{"version":3,"file":"index.cjs","sources":["../../src/utilities-fetch-client.ts","../../src/interceptors/cache-interceptor/storage-memory.ts","../../src/interceptors/cache-interceptor/storage.ts","../../src/http-client-configuration.ts","../../src/errors.ts","../../src/http-client.ts","../../src/interceptors/cache-interceptor/cach-service.ts","../../src/interceptors/cache-interceptor/cache-interceptor.ts","../../src/interceptors/cache-interceptor/storage-browser-indexdb.ts","../../src/interceptors/cache-interceptor/storage-browser.ts","../../src/interceptors/cache-interceptor/storage-browser-local.ts","../../src/interceptors/cache-interceptor/storage-browser-session.ts","../../src/interceptors/retry-interceptor.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["json","body","replacer","JSON","stringify","undefined","MemoryStorage","constructor","this","cache","Map","delete","key","has","set","value","get","clear","ICacheStorage","DI","createInterface","x","singleton","HttpClientConfiguration","baseUrl","defaults","interceptors","dispatcher","_container","resolve","IContainer","withBaseUrl","withDefaults","withInterceptor","interceptor","push","useStandardConfiguration","standardConfig","credentials","Object","assign","rejectErrorResponses","response","rejectOnError","withRetry","config","invoke","RetryInterceptor","withDispatcher","ok","createMappedError","code","details","Error","String","padStart","map","absoluteUrlRegexp","IFetchFn","fetch","instance","IHttpClient","aliasTo","HttpClient","activeRequestCount","isRequesting","isConfigured","_interceptors","_dispatcher","_createConfiguration","factory","_fetchFn","slice","configure","normalizedConfig","requestInitConfiguration","c","headers","Headers","length","filter","retryInterceptorIndex","findIndex","input","init","_trackRequestStart","request","buildRequest","processRequest","then","result","Response","Promise","Request","call","processResponse","_trackRequestEnd","error","requestContentType","parsedDefaultHeaders","parseHeaderValues","bodyObj","requestInit","getRequestUrl","isJSON","setDefaultHeaders","Blob","type","post","_callFetch","put","patch","dispose","forEach","i","dispatch","HttpClientEvent","started","drained","_applyInterceptors","successName","errorName","Type","interceptorArgs","reduce","chain","successHandler","errorHandler","identity","reason","thrower","method","parsedHeaders","$headers","name","keys","url","test","defaultHeaders","$defaultHeaders","str","parse","err","node","evt","ownerDocument","defaultView","CustomEvent","bubbles","cancelable","setTimeout","dispatchEvent","freeze","ICacheService","CacheService","CacheEvent","Set","Get","Clear","Reset","Dispose","CacheHit","CacheMiss","CacheStale","CacheStaleRefreshed","CacheExpired","CacheBackgroundRefreshed","CacheBackgroundRefreshing","CacheBackgroundStopped","storage","_platform","IPlatform","ea","IEventAggregator","_httpClient","_subscribedEvents","_interval","_timeouts","_requestMap","subscribe","event","callback","sub","subscribeOnce","setStaleTimer","staleTime","timeoutId","async","getItem","publish","_clearTimeout","startBackgroundRefresh","timer","setInterval","req","stopBackgroundRefresh","clearInterval","options","cacheItem","data","setItem","lastCached","Date","now","cacheTime","clearTimeout","id","idx","indexOf","splice","defaultCacheConfig","refreshStaleImmediate","refreshInterval","CacheInterceptor","_cacheService","_config","mark","cacheHeader","prefix","BrowserIndexDBStorage","globalThis","indexedDB","getStore","database","transaction","cacheName","objectStore","store","count","getAllKeys","open","BrowserStorage","removeItem","some","startsWith","BrowserLocalStorage","super","localStorage","BrowserSessionStorage","sessionStorage","RetryStrategy","fixed","incremental","exponential","random","defaultRetryConfig","maxRetries","interval","strategy","retryConfig","p","counter","requestClone","clone","responseError","httpClient","doRetry","delay","calculateDelay","isNaN","newRequest","beforeRetry","retryableRequest","minRandomInterval","maxRandomInterval","retryStrategies","retryCount","Math"],"mappings":"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"}