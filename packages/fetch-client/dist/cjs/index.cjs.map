{"version":3,"file":"index.cjs","sources":["../../src/utilities-fetch-client.ts","../../src/interceptors/cache-interceptor/storage-memory.ts","../../src/interceptors/cache-interceptor/storage.ts","../../src/http-client-configuration.ts","../../src/http-client.ts","../../src/interceptors/cache-interceptor/cach-service.ts","../../src/interceptors/cache-interceptor/cache-interceptor.ts","../../src/interceptors/cache-interceptor/storage-browser-indexdb.ts","../../src/interceptors/cache-interceptor/storage-browser.ts","../../src/interceptors/cache-interceptor/storage-browser-local.ts","../../src/interceptors/cache-interceptor/storage-browser-session.ts","../../src/interceptors/retry-interceptor.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null],"names":["json","body","replacer","JSON","stringify","undefined","MemoryStorage","constructor","this","cache","Map","delete","key","has","set","value","get","clear","ICacheStorage","DI","createInterface","x","singleton","HttpClientConfiguration","baseUrl","defaults","interceptors","dispatcher","_container","resolve","IContainer","withBaseUrl","withDefaults","withInterceptor","interceptor","push","useStandardConfiguration","standardConfig","credentials","Object","assign","rejectErrorResponses","response","rejectOnError","withRetry","config","invoke","RetryInterceptor","withDispatcher","ok","absoluteUrlRegexp","IFetchFn","fetch","Error","instance","IHttpClient","cachedCallback","handler","HttpClient","client","register","Registration","activeRequestCount","isRequesting","isConfigured","_interceptors","_dispatcher","_fetchFn","slice","configure","normalizedConfig","requestInitConfiguration","c","headers","Headers","length","filter","retryInterceptorIndex","findIndex","input","init","_trackRequestStart","request","buildRequest","processRequest","then","result","Response","Promise","Request","call","processResponse","_trackRequestEnd","error","requestContentType","parsedDefaultHeaders","parseHeaderValues","bodyObj","requestInit","getRequestUrl","isJSON","setDefaultHeaders","Blob","type","post","_callFetch","put","patch","dispose","forEach","i","dispatch","HttpClientEvent","started","drained","_applyInterceptors","successName","errorName","Type","interceptorArgs","reduce","chain","successHandler","errorHandler","identity","reason","thrower","method","parsedHeaders","$headers","name","keys","url","test","defaultHeaders","$defaultHeaders","str","parse","err","node","evt","ownerDocument","defaultView","CustomEvent","bubbles","cancelable","setTimeout","dispatchEvent","freeze","ICacheService","CacheService","CacheEvent","Set","Get","Clear","Reset","Dispose","CacheHit","CacheMiss","CacheStale","CacheStaleRefreshed","CacheExpired","CacheBackgroundRefreshed","CacheBackgroundRefreshing","CacheBackgroundStopped","storage","_platform","IPlatform","ea","IEventAggregator","_httpClient","_subscribedEvents","_interval","_timeouts","_requestMap","subscribe","event","callback","sub","subscribeOnce","setStaleTimer","staleTime","timeoutId","async","getItem","publish","_clearTimeout","startBackgroundRefresh","timer","setInterval","req","stopBackgroundRefresh","clearInterval","options","cacheItem","data","setItem","lastCached","Date","now","cacheTime","clearTimeout","id","idx","indexOf","splice","defaultCacheConfig","refreshStaleImmediate","refreshInterval","CacheInterceptor","_cacheService","_config","mark","cacheHeader","prefix","BrowserIndexDBStorage","globalThis","indexedDB","getStore","database","transaction","cacheName","objectStore","store","count","getAllKeys","open","BrowserStorage","removeItem","some","startsWith","BrowserLocalStorage","super","localStorage","BrowserSessionStorage","sessionStorage","RetryStrategy","fixed","incremental","exponential","random","defaultRetryConfig","maxRetries","interval","strategy","retryConfig","p","counter","requestClone","clone","responseError","httpClient","doRetry","delay","calculateDelay","isNaN","newRequest","beforeRetry","retryableRequest","minRandomInterval","maxRandomInterval","retryStrategies","retryCount","Math"],"mappings":"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"}