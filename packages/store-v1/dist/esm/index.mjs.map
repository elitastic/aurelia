{"version":3,"file":"index.mjs","sources":["../../src/history.ts","../../src/middleware.ts","../../src/logging.ts","../../src/store.ts","../../src/test-helpers.ts","../../src/decorator.ts","../../src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null],"names":["jump","state","n","isStateHistory","Error","jumpToFuture","jumpToPast","past","length","index","future","present","newPast","slice","newPresent","newFuture","nextStateHistory","presentStateHistory","nextPresent","applyLimits","limit","history","Array","isArray","DEFAULT_LOCAL_STORAGE_KEY","MiddlewarePlacement","logMiddleware","_","settings","cons","STORE","container","get","IPlatform","console","logType","undefined","localStorageMiddleware","localStorage","IWindow","key","setItem","JSON","stringify","rehydrateFromLocalStorage","storedState","getItem","parse","LogLevel","getLogType","options","definition","defaultLevel","logDefinitions","hasOwnProperty","Object","values","includes","PerformanceMeasurement","UnregisteredActionError","constructor","reducer","super","name","DevToolsRemoteDispatchError","ActionRegistrationError","ReducerNoStateError","Store","initialState","logger","_window","this","devToolsAvailable","actions","Map","middlewares","dispatchQueue","isUndoable","undoable","_state","BehaviorSubject","asObservable","devToolsOptions","disable","setupDevTools","registerHistoryMethods","registerMiddleware","placement","set","unregisterMiddleware","has","delete","isMiddlewareRegistered","middleware","registerAction","type","unregisterAction","isActionRegistered","from","find","action","resetToState","next","dispatch","params","lookupAction","Promise","reject","queueDispatch","pipe","pipeline","dispatchPipe","async","nextReducer","nextParams","push","result","resolve","handleQueue","queueItem","internalDispatch","e","shift","unregisteredAction","a","performance","mark","pipedActions","map","callingAction","join","reduce","p","concat","logDispatchedActions","info","beforeMiddleswaresResult","executeMiddlewares","getValue","Before","clearMarks","clearMeasures","resultingState","After","measurePerformance","StartEnd","measure","measures","getEntriesByName","duration","All","marks","getEntriesByType","totalDuration","startTime","updateDevToolsState","filter","prev","curr","propagateError","__REDUX_DEVTOOLS_EXTENSION__","debug","devTools","connect","init","subscribe","message","payload","byName","args","arg","catch","parsedState","send","dispatchify","store","executeSteps","shouldLogResults","steps","logStep","step","stepIdx","res","group","log","groupEnd","tryStep","err","lastStep","currentStep","forEach","skip","take","delay","defaultSelector","connectTo","_settings","selector","getSource","source","Observable","createSelectors","isSelectorObj","fallbackSelector","target","entries","targets","changeHandlers","onChanged","propertyChanged","_context","originalSetup","setup","prototype","binding","originalTeardown","teardown","unbinding","Controller","getCached","_stateSubscriptions","s","lastTargetIdx","oldState","accu","handlerName","idx","apply","arguments","sub","Subscription","closed","unsubscribe","StoreConfiguration","withInitialState","Reflect","withOptions","register","ILogger","window","initState","Registration","instance"],"mappings":"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"}