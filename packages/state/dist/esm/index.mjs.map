{"version":3,"file":"index.mjs","sources":["../../src/state-utilities.ts","../../src/interfaces.ts","../../src/action-handler.ts","../../src/interfaces-devtools.ts","../../src/store.ts","../../src/state-binding.ts","../../src/state-binding-behavior.ts","../../src/state-dispatch-binding.ts","../../src/state-templating.ts","../../src/configuration.ts","../../src/state-getter-binding.ts","../../src/state-decorator.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null],"names":["createInterface","DI","createStateBindingScope","state","scope","overrideContext","bindingContext","stateScope","Scope","create","parent","isSubscribable","v","Object","IActionHandler","IStore","IState","actionHandlerSymbol","ActionHandler","freeze","define","actionHandler","registry","action","register","c","Registration","instance","isType","r","IDevToolsExtension","x","cachedCallback","container","win","get","IWindow","devToolsExtension","__REDUX_DEVTOOLS_EXTENSION__","Store","singleton","this","aliasTo","constructor","_subs","Set","_dispatching","_dispatchQueues","_initialState","_state","resolve","optional","State","_handlers","all","_logger","ILogger","_getDevTools","lazy","subscribe","subscriber","add","unsubscribe","delete","_setState","prevState","forEach","sub","handleStateChange","getState","dispatch","push","$$action","reduce","$state","$action","handler","Promise","then","$","afterDispatch","length","shift","newState","ex","connectDevTools","options","extension","hasDevTools","Error","name","devTools","connect","init","message","info","payload","tryParseJson","type","catch","send","JSON","parse","parsedState","str","console","log","slice","undefined","atLayout","AccessorType","Layout","stateActivating","activating","StateBinding","controller","locator","observerLocator","taskQueue","ast","target","prop","store","isBound","_task","_value","_sub","_updateCount","boundFn","mode","BindingMode","toView","_controller","l","_taskQueue","_store","oL","targetProperty","updateTarget","value","targetAccessor","_targetObserver","updateCount","isCurrentValue","_unsub","$value","setValue","bind","_scope","getAccessor","astEvaluate","oneTime","unbind","cancel","handleChange","newValue","shouldQueueFlush","obsRecord","obs","version","clear","task","queueTask","updateTaskOpts","dispose","reusable","preempt","connectable","mixinAstEvaluator","mixingBindingLimited","bindingStateSubscriberMap","WeakMap","StateBindingBehavior","binding","isStateBinding","set","StateSubscriber","_wrappedScope","useScope","BindingBehavior","_binding","StateDispatchBinding","expr","_target","_targetProperty","callSource","e","$event","handleEvent","astBind","addEventListener","astUnbind","removeEventListener","StateAttributePattern","rawName","rawValue","parts","AttrSyntax","DispatchAttributePattern","StateBindingCommand","ignoreAttr","build","parser","attrMapper","attr","bindable","map","node","camelCase","def","StateBindingInstruction","$au","DispatchBindingCommand","DispatchBindingInstruction","from","to","StateBindingInstructionRenderer","renderer","_stateContainer","render","renderingCtrl","instruction","platform","exprParser","addBinding","domWriteQueue","ensureExpression","DispatchBindingInstructionRenderer","srcOrExpr","expressionType","standardRegistrations","createConfiguration","initialState","actionHandlers","AppTask","creating","IContainer","devToolsOptions","disable","optionsOrHandler","isHandler","StateDefaultConfiguration","StateGetterBinding","getValue","$get","key","fromState","context","kind","dependencies","metadata","dependenciesKey","HydratingLifecycleHooks","CreatedLifecycleHooks","Protocol","annotation","keyFor","ILifecycleHooks","hydrating","vm","vmKind","LifecycleHooks","created"],"mappings":"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"}