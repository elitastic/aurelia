{"version":3,"file":"index.cjs","sources":["../../src/state-utilities.ts","../../src/interfaces.ts","../../src/action-handler.ts","../../src/interfaces-devtools.ts","../../src/store.ts","../../src/state-binding.ts","../../src/state-binding-behavior.ts","../../src/state-dispatch-binding.ts","../../src/state-templating.ts","../../src/configuration.ts","../../src/state-getter-binding.ts","../../src/state-decorator.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null],"names":["createInterface","DI","createStateBindingScope","state","scope","overrideContext","bindingContext","stateScope","Scope","create","parent","isSubscribable","v","Object","IActionHandler","IStore","IState","actionHandlerSymbol","ActionHandler","freeze","define","actionHandler","registry","action","register","c","Registration","instance","isType","r","IDevToolsExtension","x","cachedCallback","container","win","get","IWindow","devToolsExtension","__REDUX_DEVTOOLS_EXTENSION__","Store","singleton","this","aliasTo","constructor","_subs","Set","_dispatching","_dispatchQueues","_initialState","_state","resolve","optional","State","_handlers","all","_logger","ILogger","_getDevTools","lazy","subscribe","subscriber","add","unsubscribe","delete","_setState","prevState","forEach","sub","handleStateChange","getState","_handleAction","handlers","$state","$action","handler","onResolve","s","dispatch","push","afterDispatch","$$action","shift","newState","isPromise","then","ex","connectDevTools","options","extension","hasDevTools","Error","name","devTools","connect","init","message","info","payload","tryParseJson","type","Promise","catch","send","JSON","parse","parsedState","str","console","log","slice","undefined","atLayout","AccessorType","Layout","stateActivating","activating","StateBinding","controller","locator","observerLocator","taskQueue","ast","target","prop","store","isBound","_task","_value","_sub","_updateCount","boundFn","mode","BindingMode","toView","_controller","l","_taskQueue","_store","oL","targetProperty","updateTarget","value","targetAccessor","_targetObserver","updateCount","isCurrentValue","_unsub","$value","setValue","bind","_scope","getAccessor","astEvaluate","oneTime","unbind","cancel","handleChange","newValue","shouldQueueFlush","obsRecord","obs","version","clear","task","queueTask","updateTaskOpts","dispose","preempt","connectable","mixinAstEvaluator","mixingBindingLimited","bindingStateSubscriberMap","WeakMap","StateBindingBehavior","binding","isStateBinding","set","StateSubscriber","_wrappedScope","useScope","BindingBehavior","_binding","StateDispatchBinding","expr","_target","_targetProperty","callSource","e","$event","handleEvent","astBind","addEventListener","astUnbind","removeEventListener","StateBindingCommand","ignoreAttr","build","parser","attrMapper","attr","rawValue","camelCase","bindable","map","node","StateBindingInstruction","$au","DispatchBindingCommand","DispatchBindingInstruction","from","to","StateBindingInstructionRenderer","renderer","_stateContainer","render","renderingCtrl","instruction","platform","exprParser","ensureExpression","addBinding","domQueue","DispatchBindingInstructionRenderer","srcOrExpr","expressionType","standardRegistrations","createConfiguration","initialState","actionHandlers","AppTask","creating","IContainer","devToolsOptions","disable","optionsOrHandler","isHandler","StateDefaultConfiguration","StateGetterBinding","getValue","$get","key","fromState","context","kind","dependencies","metadata","dependenciesKey","HydratingLifecycleHooks","CreatedLifecycleHooks","Protocol","annotation","keyFor","ILifecycleHooks","hydrating","vm","vmKind","LifecycleHooks","created"],"mappings":"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"}